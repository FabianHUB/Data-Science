import pandas as pd

age_threshold = int(input('Waiting for input: '))  #example: 10

df = pd.read_csv("icecream.csv")

### ADD YOUR CODE BELOW

double_scoop = pd.DataFrame([])

# loop over all avaliable flavours
for flavour in df['scoop_1'].unique():
    
    # search across all combinations of scoops
    for index1 in range(1,4):
        for index2 in range(index1+1,4):
            
            # subset to obtain double scoops and add to cumalative dataframe
            temp = df[(df['scoop_'+str(index1)] == flavour) & (df['scoop_'+str(index2)] == flavour)]
            double_scoop = pd.concat([double_scoop,temp])
            
# Remove repeated entries
double_scoop = double_scoop.groupby(double_scoop.index).first()

# final subset by age and get the number of rows
double_scoopers = double_scoop[double_scoop['age'] > age_threshold].shape[0]

# double_scoopers = 999

### ADD YOUR CODE ABOVE

print(f"The number of orders with two scoops of the same flavour and over the age threshold is {double_scoopers}.")